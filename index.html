<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Marca Personal - Retorika</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --azul-claro: #dae8fc;
            --azul-encabezado: #4472c4;
            --azul-fila-par: #d9e1f2;
            --gris-fijo: #f2f2f2;
        }

        body { font-family: 'Arial', sans-serif; background-color: #f5f5f5; display: flex; justify-content: center; padding: 20px; }
        .excel-container { background-color: white; width: 950px; border: 1px solid #ccc; padding: 25px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        
        .logo-container { text-align: center; margin-bottom: 20px; }
        .logo-container img { max-width: 250px; height: auto; }

        .header-main { background-color: #7da7d9; color: black; text-align: center; font-weight: bold; padding: 8px; border: 2px solid black; margin-bottom: 5px; }
        .sub-header { background-color: #eee; text-align: center; font-size: 13px; padding: 5px; border: 1px solid #ccc; margin-bottom: 20px; }

        .main-content { display: flex; gap: 0; align-items: flex-start; }
        .inputs-column { flex: 3; }
        .totals-column { width: 150px; }

        table { border-collapse: collapse; table-layout: fixed; width: 100%; }
        th, td { border: 1px solid #666; text-align: center; padding: 5px; font-size: 13px; height: 25px; }
        
        .bg-header-input { background-color: #d9e1f2; font-weight: bold; }
        .bg-total-val { background-color: var(--gris-fijo); font-weight: bold; }
        
        input { width: 100%; border: none; text-align: center; font-size: 14px; background: transparent; outline: none; }

        /* Contenedor Gráfica Lineal */
        .chart-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; background-color: #fff; }
        #chart-title { text-align: center; font-size: 14px; color: #666; margin-bottom: 10px; }

        .final-bar { width: 100%; display: grid; grid-template-columns: 3fr 1fr; border: 2px solid #000; margin-top: 15px; }
        .final-label { background-color: #d9e1f2; padding: 10px; text-align: center; font-weight: bold; font-size: 16px; }
        .final-value-box { display: flex; flex-direction: column; text-align: center; border-left: 2px solid #000; }
        #total-final { font-size: 18px; font-weight: bold; padding: 3px; background-color: white; }
        #status-text { background-color: #00b050; color: black; font-size: 14px; font-weight: bold; padding: 3px; border-top: 2px solid #000; transition: background 0.3s; }

        .no-alter { border: 1px solid #000; text-align: center; margin: 15px 0; padding: 3px; font-size: 14px; background-color: white; }

        .bottom-sections { display: flex; justify-content: space-between; align-items: flex-start; gap: 40px; margin-top: 10px; }

        .summary-table { width: 300px; }
        .summary-table td { text-align: left; padding: 4px 10px; border: 1px solid #ccc; }
        .summary-header { background-color: var(--azul-encabezado); color: white; font-weight: bold; }
        .row-alt { background-color: var(--azul-fila-par); }

        .rating-table { width: 450px; }
        .rating-table tr:first-child { background-color: #d9e1f2; font-weight: bold; }

        .footer-note { font-size: 12px; margin-top: 20px; color: #333; font-style: italic; }

        /* Adaptación para Móviles */
        @media (max-width: 950px) {
            body { padding: 10px; }
            .excel-container { width: 100%; padding: 15px; box-sizing: border-box; }
            .main-content { flex-direction: column; }
            .inputs-column, .totals-column { width: 100% !important; }
            table { width: 100% !important; margin-bottom: 20px !important; }
            .final-bar { grid-template-columns: 1fr; }
            .final-value-box { border-left: none; border-top: 2px solid #000; }
            .bottom-sections { flex-direction: column; gap: 20px; }
            .summary-table, .rating-table { width: 100% !important; }
            .chart-section { height: 300px; } /* Solo se aplica en móvil */
        }
    </style>
</head>
<body>

<div class="excel-container">
    <div class="logo-container"></div>
    <div class="header-main">MARCA PERSONAL</div>
    <div class="sub-header">Califique las variables (0 a 10)</div>

    <div class="main-content">
        <div class="inputs-column">
            <table style="margin-bottom: 15px;">
                <tr class="bg-header-input">
                    <td>Experiencia</td><td>Formación</td><td>Habilidades Blandas</td><td>Ejecución</td>
                </tr>
                <tr>
                    <td><input type="number" id="v1" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                    <td style="background-color: #c9daf8;"><input type="number" id="v2" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                    <td><input type="number" id="v3" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                    <td><input type="number" id="v4" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                </tr>
            </table>

            <table style="width: 50%; margin-bottom: 15px;">
                <tr class="bg-header-input"><td>Networking</td><td>Circunstancias</td></tr>
                <tr>
                    <td><input type="number" id="v5" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                    <td><input type="number" id="v6" value="0" min="0" max="10" step="1" oninput="calculate()"></td>
                </tr>
            </table>

            <table style="width: 25%;">
                <tr class="bg-header-input"><td>Mercado</td></tr>
                <tr><td><input type="number" id="v7" value="0" min="0" max="10" step="1" oninput="calculate()"></td></tr>
            </table>
        </div>

        <div class="totals-column">
            <table style="margin-bottom: 15px;">
                <tr class="bg-header-input"><td>Total</td></tr>
                <tr class="bg-total-val"><td id="total-row1">0</td></tr>
            </table>
            <table style="margin-bottom: 15px;">
                <tr class="bg-header-input"><td>Total</td></tr>
                <tr class="bg-total-val"><td id="total-row2">0</td></tr>
            </table>
            <table>
                <tr class="bg-header-input"><td>Total</td></tr>
                <tr class="bg-total-val"><td id="total-row3">0</td></tr>
            </table>
        </div>
    </div>

    <div class="chart-section">
        <div id="chart-title">Valoración de tu Marca Personal</div>
        <canvas id="lineChart" height="100"></canvas>
    </div>

    <div class="final-bar">
        <div class="final-label">VALOR TOTAL DE TU MARCA PERSONAL</div>
        <div class="final-value-box">
            <div id="total-final">0</div>
            <div id="status-text">Debajo de la Media</div>
        </div>
    </div>

    <div class="no-alter">No alterar la información que se facilita a continuación:</div>

    <div class="bottom-sections">
        <table class="summary-table">
            <tr class="summary-header"><td>Categoría</td><td>Valor</td></tr>
            <tr class="row-alt"><td>Experiencia</td><td id="res1">0</td></tr>
            <tr><td>Formación</td><td id="res2">0</td></tr>
            <tr class="row-alt"><td>Habilidades</td><td id="res3">0</td></tr>
            <tr><td>Ejecución</td><td id="res4">0</td></tr>
            <tr class="row-alt"><td>Networking</td><td id="res5">0</td></tr>
            <tr><td>Circunstancias</td><td id="res6">0</td></tr>
            <tr class="row-alt"><td>Mercado</td><td id="res7">0</td></tr>
        </table>

        <table class="rating-table">
            <tr><td>Calificación</td><td>Máxima</td><td>Mínima</td></tr>
            <tr><td>Excelente</td><td>8000</td><td>5800</td></tr>
            <tr><td>Muy Buena</td><td>5799</td><td>4000</td></tr>
            <tr><td>Buena</td><td>3999</td><td>2700</td></tr>
            <tr><td>En Media</td><td>2699</td><td>1000</td></tr>
            <tr><td>Debajo de la Media</td><td>999</td><td>0</td></tr>
        </table>
    </div>

    <div class="footer-note">*Circunstancias = suerte, tiempo...</div>
</div>

<script>
    let myChart;

    function initChart() {
        const isMobile = window.innerWidth <= 950;
        const ctx = document.getElementById('lineChart').getContext('2d');
        
        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Experiencia', 'Formación', 'Habilidades', 'Ejecución', 'Networking', 'Circunstancias', 'Mercado'],
                datasets: [{
                    label: 'Valor',
                    data: [0, 0, 0, 0, 0, 0, 0],
                    borderColor: '#4472c4',
                    backgroundColor: 'transparent',
                    borderWidth: 3,
                    pointBackgroundColor: '#4472c4',
                    pointRadius: 4,
                    tension: 0 
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: !isMobile, // Solo se desactiva en móvil
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        min: 0,
                        max: 10,
                        ticks: { stepSize: 1, color: '#666' },
                        grid: { color: '#eee' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { 
                            color: '#333', 
                            font: { size: isMobile ? 10 : 11 },
                            maxRotation: isMobile ? 45 : 0, // Solo rota en móvil
                            minRotation: isMobile ? 45 : 0
                        }
                    }
                }
            }
        });
    }

    function calculate() {
        const v = [1,2,3,4,5,6,7].map(i => {
            const input = document.getElementById('v'+i);
            let val = parseFloat(input.value) || 0;
            if (!Number.isInteger(val)) { val = Math.round(val); input.value = val; }
            return Math.min(val, 10);
        });
        
        v.forEach((val, index) => { document.getElementById('res' + (index + 1)).innerText = val; });

        if(myChart) {
            myChart.data.datasets[0].data = v;
            myChart.update();
        }

        const r1 = v[0]+v[1]+v[2]+v[3];
        const r2 = v[4]+v[5];
        const r3 = v[6];
        const total = Math.round(r1 * r2 * r3);

        document.getElementById('total-row1').innerText = Math.round(r1);
        document.getElementById('total-row2').innerText = Math.round(r2);
        document.getElementById('total-row3').innerText = Math.round(r3);
        document.getElementById('total-final').innerText = total.toLocaleString();

        const status = document.getElementById('status-text');
        if (total >= 5800) { status.innerText = "Excelente"; status.style.backgroundColor = "#00b050"; }
        else if (total >= 4000) { status.innerText = "Muy Buena"; status.style.backgroundColor = "#00b050"; }
        else if (total >= 2700) { status.innerText = "Buena"; status.style.backgroundColor = "#92d050"; }
        else if (total >= 1000) { status.innerText = "En Media"; status.style.backgroundColor = "#ffcc00"; }
        else { status.innerText = "Debajo de la Media"; status.style.backgroundColor = "#f8cecc"; }
    }

    window.onload = () => {
        initChart();
        calculate();
    };
</script>
</body>
</html>
